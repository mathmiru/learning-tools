<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>テープ図</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body{margin:0;background:#f8fafc;font-family:sans-serif;overflow:hidden}#ui-container{position:absolute;top:0;left:0;width:100%;padding:10px 15px;box-sizing:border-box;background:#fff;border-bottom:3px solid #cbd5e1;display:flex;flex-direction:column;align-items:center;gap:10px;z-index:100;transition:background .3s}.mode-add-ui{background:#fff1f2!important;border-bottom-color:#fda4af!important}.mode-sub-ui{background:#f0f9ff!important;border-bottom-color:#bae6fd!important}.row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;align-items:center;width:100%}button{padding:10px 16px;font-size:14px;cursor:pointer;border:2px solid transparent;border-radius:8px;font-weight:700;transition:.2s}#typeAdd{background:#f43f5e;color:#fff}#typeAdd.active{border-color:#881337;outline:3px solid #fb7185}#typeSub{background:#0ea5e9;color:#fff}#typeSub.active{border-color:#0c4a6e;outline:3px solid #7dd3fc}.btn-mode{background:#e2e8f0;color:#1e293b}.btn-mode.active{background:#1e293b;color:#fff;border-color:#000}.btn-go{background:#10b981;color:#fff;padding:10px 24px;font-size:16px}.input-box{display:flex;gap:8px;align-items:center;font-weight:700;font-size:15px}input{width:50px;padding:6px;font-size:18px;text-align:center;border:2px solid #cbd5e1;border-radius:6px}.hidden{display:none}
    </style>
</head>
<body>
<div id="ui-container" class="mode-add-ui">
    <div class="row"><button id="typeAdd" class="active" onclick="_0x4f2a('add')">ぜんぶを もとめる (たし算 ＋)</button><button id="typeSub" onclick="_0x4f2a('sub')">のこりを もとめる (ひき算 －)</button></div>
    <div class="row"><div id="inputAdd" class="input-box"><span>あか</span><input type="number" id="addRed" value="5"><span>あお</span><input type="number" id="addBlue" value="3"></div><div id="inputSub" class="input-box hidden"><span>ぜんぶ</span><input type="number" id="subTotal" value="8"><span>あか</span><input type="number" id="subRed" value="5"></div><button class="btn-go" onclick="_0x11ab()">やってみる！</button></div>
    <div class="row"><button id="m0" class="btn-mode active" onclick="_0x55dc(0)">①まる</button><button id="m1" class="btn-mode" onclick="_0x55dc(1)">②色テープ</button><button id="m2" class="btn-mode" onclick="_0x55dc(2)">③しろくろテープ</button></div>
</div>
<script>
let _0x22a='add',_0x33b=5,_0x44c=3,_0x55e=8,_0x66f=0,_0x77g=[];function setup(){createCanvas(windowWidth,windowHeight);rectMode(CENTER);_0x11ab();}function windowResized(){resizeCanvas(windowWidth,windowHeight);}function _0x4f2a(_0x1b2c){if(_0x1b2c===_0x22a)return;let _0x2c3d=document.getElementById('addRed'),_0x3d4e=document.getElementById('addBlue'),_0x4e5f=document.getElementById('subTotal'),_0x5f6a=document.getElementById('subRed');if(_0x1b2c==='sub'){_0x4e5f.value=Number(_0x2c3d.value)+Number(_0x3d4e.value);_0x5f6a.value=_0x2c3d.value;}else{_0x2c3d.value=_0x5f6a.value;_0x3d4e.value=Math.max(0,Number(_0x4e5f.value)-Number(_0x5f6a.value));}_0x22a=_0x1b2c;let _0x6a7b=document.getElementById('ui-container');_0x6a7b.className=(_0x1b2c==='add'?'mode-add-ui':'mode-sub-ui');document.getElementById('typeAdd').classList.toggle('active',_0x1b2c==='add');document.getElementById('typeSub').classList.toggle('active',_0x1b2c==='sub');document.getElementById('inputAdd').classList.toggle('hidden',_0x1b2c==='sub');document.getElementById('inputSub').classList.toggle('hidden',_0x1b2c==='add');}function _0x11ab(){if(_0x22a==='add'){_0x33b=Number(document.getElementById('addRed').value)||0;_0x44c=Number(document.getElementById('addBlue').value)||0;_0x55e=_0x33b+_0x44c;}else{_0x55e=Number(document.getElementById('subTotal').value)||0;_0x33b=Number(document.getElementById('subRed').value)||0;if(_0x33b>_0x55e)_0x33b=_0x55e;_0x44c=_0x55e-_0x33b;}_0x77g=[];for(let i=0;i<_0x55e;i++){_0x77g.push({t:i<_0x33b?'r':'b',p:createVector(random(width),height+100),m:_0x66f===0?0:1});}}function draw(){background(248,250,252);if(_0x55e===0)return;let _0x98a=width*0.9,_0x87b=(_0x66f===0?1.2:1.0),_0x76c=Math.min(60,_0x98a/(_0x55e*_0x87b)),_0x65d=width/2,_0x54e=height/2+100,_0x43f=(_0x66f===0?_0x76c*0.2:0),_0x32a=_0x55e*_0x76c+(Math.max(0,_0x55e-1)*_0x43f),_0x21b=_0x65d-_0x32a/2+_0x76c/2;for(let i=0;i<_0x77g.length;i++){let t=_0x77g[i];t.p.x=lerp(t.p.x,_0x21b+i*(_0x76c+_0x43f),0.12);t.p.y=lerp(t.p.y,_0x54e,0.12);t.m=lerp(t.m,(_0x66f===0?0:1),0.1);push();translate(t.p.x,t.p.y);noStroke();if(_0x66f===2)fill(255);else fill(t.t==='r'?'#f43f5e':'#0ea5e9');rect(0,0,_0x76c,_0x76c,(1-t.m)*_0x76c/2);pop();}_0xabc(_0x21b,_0x54e,_0x32a,_0x76c);}function _0xabc(_0x1a,_0x2b,_0x3c,_0x4d){let _0x5e=_0x4d*1.2,_0x6f=Math.max(16,_0x4d*0.5);textSize(_0x6f);textAlign(CENTER,CENTER);let _0x7g=_0x2b-_0x5e;stroke(0);strokeWeight(2);noFill();beginShape();vertex(_0x1a-_0x4d/2,_0x7g+8);vertex(_0x1a-_0x4d/2,_0x7g);vertex(_0x1a-_0x4d/2+_0x3c,_0x7g);vertex(_0x1a-_0x4d/2+_0x3c,_0x7g+8);endShape();noStroke();fill(0);if(_0x22a==='add'){fill('#e11d48');text("ぜんぶで ？",width/2,_0x7g-_0x6f);}else{text("ぜんぶで "+_0x55e,width/2,_0x7g-_0x6f);}let _0x8h=_0x33b*_0x4d+(_0x66f===0?Math.max(0,_0x33b-1)*_0x4d*0.2:0);let _0x9i=_0x3c-_0x8h-(_0x66f===0&&_0x33b>0&&_0x44c>0?_0x4d*0.2:0);let _0xa1=_0x1a+_0x8h/2-_0x4d/2;let _0xb2=_0x1a+_0x8h+(_0x66f===0&&_0x33b>0&&_0x44c>0?_0x4d*0.2:0)+_0x9i/2-_0x4d/2;fill(0);if(_0x33b>0)text(_0x33b,_0xa1,_0x2b+_0x5e);if(_0x44c>0){if(_0x22a==='sub'){fill('#0284c7');text("？",_0xb2,_0x2b+_0x5e);}else{text(_0x44c,_0xb2,_0x2b+_0x5e);}}if(_0x66f>0){noFill();stroke(0);strokeWeight(2);if(_0x33b>0)rect(_0xa1,_0x2b,_0x8h,_0x4d);if(_0x44c>0)rect(_0xb2,_0x2b,_0x9i,_0x4d);}}function _0x55dc(_0x123){_0x66f=_0x123;document.getElementById('m0').classList.toggle('active',_0x123===0);document.getElementById('m1').classList.toggle('active',_0x123===1);document.getElementById('m2').classList.toggle('active',_0x123===2);}
</script>
</body>
</html>
