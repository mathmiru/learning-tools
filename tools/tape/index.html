<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>学習支援ツール</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body{margin:0;background:#f8fafc;font-family:sans-serif;overflow:hidden;touch-action:manipulation}
        #ui-container{position:absolute;top:0;left:0;width:100%;padding:8px;box-sizing:border-box;background:#fff;border-bottom:3px solid #cbd5e1;display:flex;flex-direction:column;align-items:center;gap:8px;z-index:100;transition:background .3s}
        .mode-add-ui{background:#fff1f2!important;border-bottom-color:#fda4af!important}
        .mode-sub-ui{background:#f0f9ff!important;border-bottom-color:#bae6fd!important}
        .row{display:flex;gap:6px;flex-wrap:wrap;justify-content:center;align-items:center;width:100%}
        button{padding:12px 10px;font-size:15px;cursor:pointer;border:2px solid transparent;border-radius:10px;font-weight:700;transition:.2s;flex:1;min-width:120px;min-height:48px;display:flex;justify-content:center;align-items:center}
        #typeAdd{background:#f43f5e;color:#fff}#typeAdd.active{border-color:#881337;box-shadow:0 0 0 3px #fb7185}
        #typeSub{background:#0ea5e9;color:#fff}#typeSub.active{border-color:#0c4a6e;box-shadow:0 0 0 3px #7dd3fc}
        .btn-mode{background:#e2e8f0;color:#1e293b;min-width:80px}
        .btn-mode.active{background:#1e293b;color:#fff;border-color:#000}
        .btn-go{background:#10b981;color:#fff;font-size:18px;flex:none;min-width:120px}
        .input-box{display:flex;gap:4px;align-items:center;font-weight:700;background:rgba(0,0,0,.05);padding:4px 8px;border-radius:8px}
        input{width:60px;height:40px;font-size:20px;text-align:center;border:2px solid #cbd5e1;border-radius:6px;background:#fff}
        .hidden{display:none}
    </style>
</head>
<body>
<div id="ui-container" class="mode-add-ui">
    <div class="row">
        <button id="typeAdd" class="active" onclick="_0x4f2a('add')">ぜんぶ(＋)</button>
        <button id="typeSub" onclick="_0x4f2a('sub')">のこり(－)</button>
    </div>
    <div class="row">
        <div id="inputAdd" class="input-box">
            <span>あか</span><input type="number" id="addRed" value="5">
            <span>あお</span><input type="number" id="addBlue" value="3">
        </div>
        <div id="inputSub" class="input-box hidden">
            <span>ぜんぶ</span><input type="number" id="subTotal" value="8">
            <span>あか</span><input type="number" id="subRed" value="5">
        </div>
        <button class="btn-go" onclick="_0x11ab()">やってみる！</button>
    </div>
    <div class="row">
        <button id="m0" class="btn-mode active" onclick="_0x55dc(0)">①まる</button>
        <button id="m1" class="btn-mode" onclick="_0x55dc(1)">②色</button>
        <button id="m2" class="btn-mode" onclick="_0x55dc(2)">③線</button>
    </div>
</div>
<script>
let _0x1a='add',_0x2b=5,_0x3c=3,_0x4d=8,_0x5e=0,_0x6f=[];function setup(){createCanvas(windowWidth,windowHeight);rectMode(CENTER);_0x11ab()}function windowResized(){resizeCanvas(windowWidth,windowHeight)}function _0x4f2a(t){if(t===_0x1a)return;let a=document.getElementById('addRed'),b=document.getElementById('addBlue'),c=document.getElementById('subTotal'),d=document.getElementById('subRed');if(t==='sub'){c.value=Number(a.value)+Number(b.value);d.value=a.value}else{a.value=d.value;b.value=Math.max(0,Number(c.value)-Number(d.value))}_0x1a=t;let u=document.getElementById('ui-container');u.className=(t==='add'?'mode-add-ui':'mode-sub-ui');document.getElementById('typeAdd').classList.toggle('active',t==='add');document.getElementById('typeSub').classList.toggle('active',t==='sub');document.getElementById('inputAdd').classList.toggle('hidden',t==='sub');document.getElementById('inputSub').classList.toggle('hidden',t==='add')}function _0x11ab(){if(_0x1a==='add'){_0x2b=Number(document.getElementById('addRed').value)||0;_0x3c=Number(document.getElementById('addBlue').value)||0;_0x4d=_0x2b+_0x3c}else{_0x4d=Number(document.getElementById('subTotal').value)||0;_0x2b=Number(document.getElementById('subRed').value)||0;_0x3c=Math.max(0,_0x4d-_0x2b)}_0x6f=[];for(let i=0;i<_0x4d;i++){_0x6f.push({t:i<_0x2b?'r':'b',p:createVector(random(width),height+100),m:_0x5e===0?0:1})}}function draw(){background(248,250,252);if(_0x4d===0)return;let w=width*0.85,f=(_0x5e===0?1.2:1),s=Math.min(height/12,w/(_0x4d*f)),cx=width/2,cy=height/2+130,g=(_0x5e===0?s*.2:0),tw=_0x4d*s+(_0x4d-1)*g,sx=cx-tw/2+s/2;for(let i=0;i<_0x6f.length;i++){let t=_0x6f[i];t.p.x=lerp(t.p.x,sx+i*(s+g),.15);t.p.y=lerp(t.p.y,cy,.15);t.m=lerp(t.m,(_0x5e===0?0:1),.1);push();translate(t.p.x,t.p.y);noStroke();if(_0x5e===2)fill(255);else fill(t.t==='r'?'#f43f5e':'#0ea5e9');rect(0,0,s,s,(1-t.m)*s/2);pop()}let z=Math.max(16,s*.6),ly=cy-s*1.2-50,ny=cy+s*1.2+40;stroke('#94a3b8');strokeWeight(1.5);noFill();let _eo=2;beginShape();vertex(sx-s/2-_eo,ly+10);vertex(sx-s/2-_eo,ly);vertex(sx-s/2+tw+_eo,ly);vertex(sx-s/2+tw+_eo,ly+10);endShape();noStroke();fill(0);textSize(z);textAlign(CENTER,CENTER);if(_0x1a==='add'){fill('#e11d48');text("ぜんぶで ？",width/2,ly-z-5)}else{text("ぜんぶで "+_0x4d,width/2,ly-z-5)}let rw=_0x2b*s+(_0x5e===0?Math.max(0,_0x2b-1)*s*.2:0),bw=tw-rw-(_0x5e===0&&_0x2b>0&&_0x3c>0?s*.2:0),rx=sx+rw/2-s/2,bx=sx+rw+(_0x5e===0&&_0x2b>0&&_0x3c>0?s*.2:0)+bw/2-s/2;fill(0);if(_0x2b>0)text(_0x2b,rx,ny);if(_0x3c>0){if(_0x1a==='sub'){fill('#0284c7');text("？",bx,ny)}else{text(_0x3c,bx,ny)}}if(_0x5e>0){noFill();stroke(0);strokeWeight(2);if(_0x2b>0)rect(rx,cy,rw,s);if(_0x3c>0)rect(bx,cy,bw,s)}}function _0x55dc(n){_0x5e=n;document.getElementById('m0').classList.toggle('active',n===0);document.getElementById('m1').classList.toggle('active',n===1);document.getElementById('m2').classList.toggle('active',n===2)}
</script>
</body>
</html>
