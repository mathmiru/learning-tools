<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>学習支援ツール</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body{margin:0;background:#f8fafc;font-family:sans-serif;overflow:hidden;touch-action:manipulation}
        #ui-container{position:absolute;top:0;left:0;width:100%;padding:8px;box-sizing:border-box;background:#fff;border-bottom:3px solid #cbd5e1;display:flex;flex-direction:column;align-items:center;gap:8px;z-index:100;transition:background .3s}
        .mode-add-ui{background:#fff1f2!important;border-bottom-color:#fda4af!important}
        .mode-sub-ui{background:#f0f9ff!important;border-bottom-color:#bae6fd!important}
        .row{display:flex;gap:6px;flex-wrap:wrap;justify-content:center;align-items:center;width:100%}
        button{padding:12px 10px;font-size:15px;cursor:pointer;border:2px solid transparent;border-radius:10px;font-weight:700;transition:.2s;flex:1;min-width:120px;min-height:48px;display:flex;justify-content:center;align-items:center;text-align:center}
        #typeAdd{background:#f43f5e;color:#fff}#typeAdd.active{border-color:#881337;box-shadow:0 0 0 3px #fb7185}
        #typeSub{background:#0ea5e9;color:#fff}#typeSub.active{border-color:#0c4a6e;box-shadow:0 0 0 3px #7dd3fc}
        .btn-mode{background:#e2e8f0;color:#1e293b;flex:1;min-width:80px}
        .btn-mode.active{background:#1e293b;color:#fff;border-color:#000}
        .btn-go{background:#10b981;color:#fff;font-size:18px;flex:2;min-width:150px}
        .input-box{display:flex;gap:4px;align-items:center;font-weight:700;font-size:16px;background:rgba(0,0,0,0.05);padding:4px 8px;border-radius:8px}
        input{width:60px;height:40px;font-size:20px;text-align:center;border:2px solid #cbd5e1;border-radius:6px;background:#fff}
        .hidden{display:none}@media(max-width:480px){button{font-size:13px;padding:8px 4px}input{width:50px;height:36px;font-size:18px}}
    </style>
</head>
<body>
<div id="ui-container" class="mode-add-ui">
    <div class="row"><button id="typeAdd" class="active" onclick="_0x4f2a('add')">ぜんぶ(＋)</button><button id="typeSub" onclick="_0x4f2a('sub')">のこり(－)</button></div>
    <div class="row"><div id="inputAdd" class="input-box"><span>あか</span><input type="number" id="addRed" value="5"><span>あお</span><input type="number" id="addBlue" value="3"></div><div id="inputSub" class="input-box hidden"><span>ぜんぶ</span><input type="number" id="subTotal" value="8"><span>あか</span><input type="number" id="subRed" value="5"></div><button class="btn-go" onclick="_0x11ab()">やってみる！</button></div>
    <div class="row"><button id="m0" class="btn-mode active" onclick="_0x55dc(0)">①まる</button><button id="m1" class="btn-mode" onclick="_0x55dc(1)">②色</button><button id="m2" class="btn-mode" onclick="_0x55dc(2)">③線</button></div>
</div>
<script>
let _0x22a='add',_0x33b=5,_0x44c=3,_0x55e=8,_0x66f=0,_0x77g=[];function setup(){createCanvas(windowWidth,windowHeight);rectMode(CENTER);_0x11ab();}function windowResized(){resizeCanvas(windowWidth,windowHeight);}function _0x4f2a(_0x1b2c){if(_0x1b2c===_0x22a)return;let a=document.getElementById('addRed'),b=document.getElementById('addBlue'),c=document.getElementById('subTotal'),d=document.getElementById('subRed');if(_0x1b2c==='sub'){c.value=Number(a.value)+Number(b.value);d.value=a.value;}else{a.value=d.value;b.value=Math.max(0,Number(c.value)-Number(d.value));}_0x22a=_0x1b2c;let u=document.getElementById('ui-container');u.className=(_0x1b2c==='add'?'mode-add-ui':'mode-sub-ui');document.getElementById('typeAdd').classList.toggle('active',_0x1b2c==='add');document.getElementById('typeSub').classList.toggle('active',_0x1b2c==='sub');document.getElementById('inputAdd').classList.toggle('hidden',_0x1b2c==='sub');document.getElementById('inputSub').classList.toggle('hidden',_0x1b2c==='add');}function _0x11ab(){if(_0x22a==='add'){_0x33b=Number(document.getElementById('addRed').value)||0;_0x44c=Number(document.getElementById('addBlue').value)||0;_0x55e=_0x33b+_0x44c;}else{_0x55e=Number(document.getElementById('subTotal').value)||0;_0x33b=Number(document.getElementById('subRed').value)||0;_0x44c=Math.max(0,_0x55e-_0x33b);}_0x77g=[];for(let i=0;i<_0x55e;i++){_0x77g.push({t:i<_0x33b?'r':'b',p:createVector(random(width),height+100),m:_0x66f===0?0:1});}}function draw(){background(248,250,252);if(_0x55e===0)return;let w=width*0.9,f=(_0x66f===0?1.2:1),s=Math.min(height/8,w/(_0x55e*f)),cx=width/2,cy=height/2+80,g=(_0x66f===0?s*0.2:0),tw=_0x55e*s+(_0x55e-1)*g,sx=cx-tw/2+s/2;for(let i=0;i<_0x77g.length;i++){let t=_0x77g[i];t.p.x=lerp(t.p.x,sx+i*(s+g),0.15);t.p.y=lerp(t.p.y,cy,0.15);t.m=lerp(t.m,(_0x66f===0?0:1),0.1);push();translate(t.p.x,t.p.y);noStroke();if(_0x66f===2)fill(255);else fill(t.t==='r'?'#f43f5e':'#0ea5e9');rect(0,0,s,s,(1-t.m)*s/2);pop();}_0xabc(sx,cy,tw,s);}function _0xabc(_0x1,_0x2,_0x3,_0x4){let o=_0x4*1.3,z=Math.max(14,_0x4*0.5);textSize(z);textAlign(CENTER,CENTER);let ly=_0x2-o;stroke(0);strokeWeight(2);noFill();beginShape();vertex(_0x1-_0x4/2,ly+8);vertex(_0x1-_0x4/2,ly);vertex(_0x1-_0x4/2+_0x3,ly);vertex(_0x1-_0x4/2+_0x3,ly+8);endShape();noStroke();fill(0);if(_0x22a==='add'){fill('#e11d48');text("ぜんぶで ？",width/2,ly-z*0.8);}else{text("ぜんぶで "+_0x55e,width/2,ly-z*0.8);}let rw=_0x33b*_0x4+(_0x66f===0?Math.max(0,_0x33b-1)*_0x4*0.2:0);let bw=_0x3-rw-(_0x66f===0&&_0x33b>0&&_0x44c>0?_0x4*0.2:0);let rx=_0x1+rw/2-_0x4/2;let bx=_0x1+rw+(_0x66f===0&&_0x33b>0&&_0x44c>0?_0x4*0.2:0)+bw/2-_0x4/2;fill(0);if(_0x33b>0)text(_0x33b,rx,_0x2+o);if(_0x44c>0){if(_0x22a==='sub'){fill('#0284c7');text("？",bx,_0x2+o);}else{text(_0x44c,bx,_0x2+o);}}if(_0x66f>0){noFill();stroke(0);strokeWeight(2);if(_0x33b>0)rect(rx,_0x2,rw,_0x4);if(_0x44c>0)rect(bx,_0x2,bw,_0x4);}}function _0x55dc(n){_0x66f=n;document.getElementById('m0').classList.toggle('active',n===0);document.getElementById('m1').classList.toggle('active',n===1);document.getElementById('m2').classList.toggle('active',n===2);}
</script>
</body>
</html>
