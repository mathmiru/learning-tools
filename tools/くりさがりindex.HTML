<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>くりさがり(２ケタまで）</title>

<style>
body {
  font-family: "Arial Rounded MT Bold", system-ui;
  background: #f5fbff;
  text-align: center;
  padding: 10px;
}

h1 { font-size: 1.6em; }

input {
  font-size: 1.3em;
  width: 60px;
  text-align: center;
  border-radius: 8px;
  border: 2px solid #ccc;
}

.problem {
  font-size: 1.8em;
  margin: 10px 0;
}

.learn-box {
  background: #ffffff;
  border-radius: 18px;
  padding: 12px;
  margin: 15px auto;
  max-width: 520px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.place-row {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.place {
  width: 230px;
}

.label {
  font-size: 1.05em;
  margin-bottom: 5px;
}

.blocks {
  min-height: 160px;
}

.ten {
  background: #4da6ff;
  color: white;
  border-radius: 10px;
  padding: 12px;
  margin: 6px auto;
  width: 80%;
  cursor: pointer;
}

.ones-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 4px;
}

.one {
  border-radius: 50%;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9em;
  cursor: pointer;
}

.one.normal { background: #ffcc66; }
.one.from-ten { background: #7fc8ff; }

button {
  margin: 8px;
  font-size: 1.05em;
  padding: 6px 14px;
  border-radius: 10px;
  border: none;
  background: #66bb6a;
  color: white;
  cursor: pointer;
}

.progress {
  margin-top: 14px;
  font-size: 1.1em;
}

.bar-wrapper {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin-top: 6px;
}

.bar {
  display: grid;
  grid-template-columns: repeat(10, 20px);
  gap: 4px;
}

.bar div {
  width: 20px;
  height: 20px;
  border-radius: 5px;
  background: #ddd;
}

.bar .done { background: #ff9933; }

.scale {
  display: flex;
  flex-direction: column;
  gap: 8px;
  font-size: 0.8em;
  color: #bbb;
  padding-top: 2px;
}

.notice {
  font-size: 0.9em;
  color: #888;
  height: 1.2em;
  margin-top: 6px;
}
</style>
</head>

<body>

<h1>くりさがり(２ケタまで）</h1>

<div class="problem">
  <input id="top" type="number" min="10" max="99" value="15">
  −
  <input id="bottom" type="number" min="0" max="99" value="9">
</div>

<button onclick="start()">スタート</button>

<div class="learn-box">
  <div class="place-row">

    <!-- 10のかたまり -->
    <div class="place">
      <div class="label">10の かたまり（タップで ばらす）</div>
      <div id="tens" class="blocks"></div>
    </div>

    <!-- 1のかたまり -->
    <div class="place">
      <div class="label">1の かたまり（タップで ひく）</div>
      <div id="ones" class="blocks ones-grid"></div>
      <button onclick="mergeTen()">10こで 10のかたまりに もどす</button>
    </div>

  </div>
</div>

<div class="progress">
  いま ひいた かず
  <div class="bar-wrapper">
    <div id="bar" class="bar"></div>
    <div id="scale" class="scale"></div>
  </div>
</div>

<div id="notice" class="notice"></div>

<button onclick="reset()">もういちど</button>

<script>
let tens, ones, fromTenOnes;
let totalSubtract, subtracted;

const tensDiv = document.getElementById("tens");
const onesDiv = document.getElementById("ones");
const bar = document.getElementById("bar");
const scale = document.getElementById("scale");
const notice = document.getElementById("notice");
const topInput = document.getElementById("top");
const bottomInput = document.getElementById("bottom");

function start() {
  const top = Number(topInput.value);
  const bottom = Number(bottomInput.value);

  if (top < bottom) {
    alert("うえの かずを おおきく しよう");
    return;
  }

  tens = Math.floor(top / 10);
  ones = top % 10;
  fromTenOnes = 0;

  totalSubtract = bottom;
  subtracted = 0;
  notice.textContent = "";

  render();
}

function render() {
  tensDiv.innerHTML = "";
  onesDiv.innerHTML = "";
  bar.innerHTML = "";
  scale.innerHTML = "";

  for (let i = 0; i < tens; i++) {
    const t = document.createElement("div");
    t.className = "ten";
    t.textContent = "10";
    t.onclick = splitTen;
    tensDiv.appendChild(t);
  }

  for (let i = 0; i < fromTenOnes; i++) createOne("from-ten");
  for (let i = 0; i < ones; i++) createOne("normal");

  for (let i = 0; i < totalSubtract; i++) {
    const b = document.createElement("div");
    if (i < subtracted) b.className = "done";
    bar.appendChild(b);
  }

  const rows = Math.ceil(totalSubtract / 10);
  for (let i = 1; i <= rows; i++) {
    const s = document.createElement("div");
    s.textContent = i * 10;
    scale.appendChild(s);
  }
}

function createOne(type) {
  const o = document.createElement("div");
  o.className = "one " + type;
  o.textContent = "1";
  o.onclick = removeOne;
  onesDiv.appendChild(o);
}

function splitTen() {
  if (tens > 0) {
    tens--;
    fromTenOnes += 10;
    render();
  }
}

function mergeTen() {
  if (ones + fromTenOnes >= 10) {
    tens++;
    let need = 10;
    if (fromTenOnes >= need) fromTenOnes -= need;
    else {
      need -= fromTenOnes;
      fromTenOnes = 0;
      ones -= need;
    }
    render();
  }
}

function removeOne() {
  if (subtracted >= totalSubtract) return;

  if (fromTenOnes > 0) fromTenOnes--;
  else if (ones > 0) ones--;
  else {
    splitTen();
    fromTenOnes--;
  }

  subtracted++;
  notice.textContent = subtracted % 10 === 0 ? `${subtracted} ひいたよ！` : "";
  render();
}

function reset() { start(); }
start();
</script>

</body>
</html>


