<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>PI Lab</title><style>:root{--b:#1a1a1a;--p:#2a2a2a;--t:#eee;--a:#3498db;--m:#2ecc71;--h:#e74c3c}*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;touch-action:manipulation}body{font-family:sans-serif;background:var(--b);color:var(--t);margin:0;height:100dvh;display:flex;flex-direction:column;overflow:hidden;user-select:none}header{height:44px;display:flex;padding:0 5px;background:#000;border-bottom:1px solid #333}.tabs{display:flex;gap:4px;width:100%}.tab-btn{flex:1;background:#333;color:#888;border:none;border-radius:4px;font-size:.7rem;font-weight:700;cursor:pointer}.active{background:var(--a);color:#fff}main{flex:1;display:flex;flex-direction:column;min-height:0}.v-a{flex:1;display:flex;align-items:center;justify-content:center;padding:8px}canvas{max-width:100%;max-height:100%;border-radius:8px;background:#F0EAD6}#c{background:#000}.p{background:var(--p);border-top:1px solid #444;padding:10px;display:flex;flex-direction:column;gap:8px}.f{font-family:monospace;font-size:.8rem;color:#aaa;text-align:center;background:#111;padding:4px;border-radius:4px}.res{background:#000;padding:8px;border-radius:6px;text-align:center;font-family:monospace;font-size:1.3rem;font-weight:700;letter-spacing:1px}#r{color:#555}.ok{color:var(--m)}.no{color:var(--h)}.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center}.s-i{background:#111;padding:4px 8px;border-radius:4px;font-size:.7rem;display:flex;justify-content:space-between}.i-a{display:flex;flex-direction:column;gap:4px}.run{background:var(--a);color:#fff;border:none;padding:10px;border-radius:4px;font-weight:700;cursor:pointer}.rst{font-size:.6rem;color:#666;text-align:center;text-decoration:underline;cursor:pointer}@media(min-width:600px){main{flex-direction:row}.p{width:280px;height:100%;border-left:1px solid #444}.grid{grid-template-columns:1fr}}</style></head><body><header><div class="tabs"><button id="b1" class="tab-btn active" onclick="sw('b')">ビュフォンの針</button><button id="b2" class="tab-btn" onclick="sw('m')">モンテカルロ法</button></div></header><main><div class="v-a"><canvas id="cv"></canvas></div><div class="p"><div id="f" class="f">π ≈ 2 × (N / C)</div><div class="res" id="r">---</div><div class="grid"><div class="st"><div class="s-i"><span>合計(N):</span><span id="n1">0</span></div><div class="s-i" style="color:var(--h)"><span id="l">線に触れた数(C):</span><span id="n2">0</span></div><div class="rst" onclick="rs()">リセット</div></div><div class="i-a"><div id="id" style="font-size:.6rem;color:var(--a)">落とす針の数:</div><input type="number" id="v" value="1" min="1"><button class="run" onclick="go()">シミュレート実行</button></div></div></div></main><script>const T="3.14159265358979323846";let m='b',c=document.getElementById('cv'),x=c.getContext('2d'),s,d={b:{t:0,c:0},m:{t:0,i:0}};function inC(){const a=c.parentElement;s=Math.min(a.clientWidth,a.clientHeight)-10;c.width=c.height=s;bg()}function bg(){x.clearRect(0,0,s,s);if(m==='b'){x.fillStyle="#F0EAD6";x.fillRect(0,0,s,s);x.strokeStyle='#aaa';const p=s/6;for(let y=p/2;y<s;y+=p){x.beginPath();x.moveTo(0,y);x.lineTo(s,y);x.stroke()}}else{x.fillStyle="#000";x.fillRect(0,0,s,s);x.beginPath();x.arc(s/2,s/2,s/2-2,0,Math.PI*2);x.strokeStyle="#444";x.stroke()}}function go(){const n=parseInt(document.getElementById('v').value)||1;if(m==='b'){const p=s/6;for(let i=0;i<n;i++){const cx=Math.random()*s,cy=Math.random()*s,a=Math.random()*Math.PI,r=p/2,y1=cy-r*Math.sin(a),y2=cy+r*Math.sin(a),v=Math.floor(y1/p)!==Math.floor(y2/p);if(v)d.b.c++;d.b.t++;x.beginPath();x.moveTo(cx-r*Math.cos(a),y1);x.lineTo(cx+r*Math.cos(a),y2);x.strokeStyle=v?"rgba(231,76,60,0.8)":"rgba(80,80,80,0.3)";x.lineWidth=v?2:1;x.stroke()}up(2*d.b.t/d.b.c,d.b.t,d.b.c)}else{const r=s/2;for(let i=0;i<n;i++){const px=Math.random()*s,py=Math.random()*s,v=(px-r)**2+(py-r)**2<=r**2;if(v)d.m.i++;d.m.t++;x.fillStyle=v?"rgba(231,76,60,0.85)":"rgba(52,152,219,0.75)";x.fillRect(px-1.25,py-1.25,2.5,2.5)}up(4*d.m.i/d.m.t,d.m.t,d.m.i)}}function up(p,t,h){document.getElementById('n1').innerText=t.toLocaleString();document.getElementById('n2').innerText=h.toLocaleString();const e=document.getElementById('r');if(!t||!h||!isFinite(p)){e.innerHTML="---";e.style.color="#555";return}e.style.color="#eee";const k=p.toFixed(10);let g="",f=false;for(let i=0;i<k.length;i++){if(!f&&k[i]===T[i])g+=`<span class="ok">${k[i]}</span>`;else{f=true;g+=`<span class="no">${k[i]}</span>`}};e.innerHTML=g}function sw(v){m=v;document.getElementById('b1').className=v==='b'?'tab-btn active':'tab-btn';document.getElementById('b2').className=v==='m'?'tab-btn active':'tab-btn';document.getElementById('f').innerText=v==='b'?'π ≈ 2 × (N / C)':'π ≈ 4 × (M / N)';document.getElementById('l').innerText=v==='b'?'線に触れた数(C):':'円の中に入った数(M):';document.getElementById('id').innerText=v==='b'?'落とす針の数:':'打つ点の数:';rs()}function rs(){d={b:{t:0,c:0},m:{t:0,i:0}};inC();up(0,0,0)}window.onload=inC;window.onresize=inC;</script></body></html>
